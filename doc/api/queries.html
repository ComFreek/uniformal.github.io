<!doctype html>
<html lang="en">
	<!-- This is the layout used for all pages in the wiki-style documentation.
        The wiki files must have "layout: doc" in their front matter.
        This file can use page.NAME to refer to variables declared in the front matter
        and content to refer to the body of the md file.
   -->

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">
    <!--
      Do not use base tag: <base href="/uniformal.github.io/" />
      Since otherwise we could not keep links in the documentation relative anymore - without a hassle at least.
      We would always have to prepend doc/ or something.

      Hence, use e.g. `/uniformal.github.io/lib/css/bootstrap.min.css` to refer to assets in this file only.
    -->
    <link rel="icon" href="https://comfreek.github.io/uniformal.github.io/favicon.ico">

    <title>MMT - Queries</title>

    <link href="https://comfreek.github.io/uniformal.github.io/lib/css/bootstrap.min.css" rel="stylesheet" />
	  <link href="https://comfreek.github.io/uniformal.github.io/lib/css/doc.css" rel="stylesheet" />
		<link href="https://comfreek.github.io/uniformal.github.io/lib/css/pygments-default.css" rel="stylesheet" />
	
  </head>
  <body>
	
<nav class="navbar navbar-expand navbar-dark site-header" site-header >
    <div class="container">
        <a class="navbar-brand" href="/">
            <img src="https://comfreek.github.io/uniformal.github.io/lib/css/img/logo_dark.svg" width="30" height="30" class="d-inline-block align-top" alt="">
            The MMT Language and System
        </a>
    </div>
</nav>

	
		<div class="container-fluid main">
			<div class="row">
				<div class="col-12 col-md-3 col-xl-2">
					<ul class="nav flex-column">
						


<div class="list-group">
  
    


    



<a class="list-group-item list-group-item-action "
    
        href="https://comfreek.github.io/uniformal.github.io/doc/"
    
>
    Overview
</a>

  
    


    








<a class="list-group-item list-group-item-action expandable " href="https://comfreek.github.io/uniformal.github.io/doc/setup/">
    Setting up MMT
</a>





  
    


    








<a class="list-group-item list-group-item-action expandable " href="https://comfreek.github.io/uniformal.github.io/doc/tutorials/">
    Tutorials
</a>





  
    


    








<a class="list-group-item list-group-item-action expandable " href="https://comfreek.github.io/uniformal.github.io/doc/philosophy/">
    The Philosophy behind MMT
</a>





  
    


    








<a class="list-group-item list-group-item-action expandable " href="https://comfreek.github.io/uniformal.github.io/doc/language/">
    The MMT Language
</a>





  
    


    








<a class="list-group-item list-group-item-action expandable " href="https://comfreek.github.io/uniformal.github.io/doc/archives/">
    MMT-Archives
</a>





  
    


    








<a class="list-group-item list-group-item-action expandable active" href="https://comfreek.github.io/uniformal.github.io/doc/api/">
    The MMT API
</a>




    <div class="list-group">
        
            


    



<a class="list-group-item list-group-item-action "
    
        href="https://comfreek.github.io/uniformal.github.io/doc/api/controller.html"
    
>
    The Controller
</a>

        
            


    








<a class="list-group-item list-group-item-action expandable " href="https://comfreek.github.io/uniformal.github.io/doc/api/syntax/">
    Data Structures for the MMT Language
</a>





        
            


    








<a class="list-group-item list-group-item-action expandable active" href="https://comfreek.github.io/uniformal.github.io/doc/api/queries.html">
    Queries
</a>




    <div class="list-group">
        
            


    



<a class="list-group-item list-group-item-action "
    
        href="https://comfreek.github.io/uniformal.github.io/doc/api/query-examples.html"
    
>
    Query Examples with the MMT API
</a>

        
    </div>


        
            


    








<a class="list-group-item list-group-item-action expandable " href="https://comfreek.github.io/uniformal.github.io/doc/api/extensions/">
    Extensions
</a>





        
            


    



<a class="list-group-item list-group-item-action "
    
        href="https://comfreek.github.io/uniformal.github.io/doc/api/log.html"
    
>
    Logging
</a>

        
            


    








<a class="list-group-item list-group-item-action expandable " href="https://comfreek.github.io/uniformal.github.io/doc/api/checking/">
    Checking Judgements
</a>





        
    </div>


  
    


    








<a class="list-group-item list-group-item-action expandable " href="https://comfreek.github.io/uniformal.github.io/doc/applications/">
    Applications and Projects based on MMT
</a>





  
    


    








<a class="list-group-item list-group-item-action expandable " href="https://comfreek.github.io/uniformal.github.io/doc/development/">
    Development
</a>





  
    


    



<a class="list-group-item list-group-item-action "
    
        href="https://comfreek.github.io/uniformal.github.io/doc/community/"
    
>
    Community & Communication
</a>

  
    


    



<a class="list-group-item list-group-item-action "
    
        href="https://comfreek.github.io/uniformal.github.io/doc/contribs"
    
>
    Contributed Articles
</a>

  
</div>
					</ul>
				</div>
				<div class="col-12 col-md-9 col-xl-8 content">
					<h2>Queries</h2>
					<hr />
	
					<p><strong>QMT</strong> is an MMT-based query language.
It was first described in the <a href="http://kwarc.info/frabe/Research/rabe_querying_12.pdf">corresponding paper</a>.</p>

<h3 id="queries">Queries</h3>

<p>QMT uses three basic concepts: <em>types</em>, <em>queries</em>, and <em>propositions</em>.</p>

<ul>
  <li><strong>Types</strong> inherit from <a href="apidoc://info.kwarc.mmt.api.ontology.QueryType"><code class="highlighter-rouge">ontology.QueryType</code></a>. Types are either products of <a href="apidoc://info.kwarc.mmt.api.ontology.QueryBaseType"><code class="highlighter-rouge">ontology.QueryBaseType</code></a>s or the power type of such a product.</li>
  <li><strong>Queries</strong> inherit from <a href="apidoc://info.kwarc.mmt.api.ontology.Query"><code class="highlighter-rouge">ontology.Query</code></a>. They are typed expressions.</li>
  <li><strong>Propositions</strong> inherit from <a href="apidoc://info.kwarc.mmt.api.ontology.Prop"><code class="highlighter-rouge">ontology.Prop</code></a>. They are expressions that are used as side conditions within queries.</li>
</ul>

<p>The specific types, queries, and propositions can be best understood by browsing the <a href="https://uniformal.github.io/apidoc/index.html">API documentation</a> and the known subclasses for the respective class.</p>

<p>At the moment the only concrete syntax for queries is an ad hoc XML format.
The algorithms for parsing, type inference, and validity checking for queries are straightforward and defined in the respective companion objects <a href="apidoc://info.kwarc.mmt.api.ontology.Query$"><code class="highlighter-rouge">ontology.Query</code></a> and <a href="apidoc://info.kwarc.mmt.api.ontology.Prop$"><code class="highlighter-rouge">ontology.Prop</code></a>.</p>

<h3 id="the-mmt-ontology-t-box">The MMT Ontology (T-Box)</h3>
<p>The MMT ontology is a fragment of the query language.</p>

<ul>
  <li>The QueryBaseType <a href="apidoc://info.kwarc.mmt.api.ontology.PathType"><code class="highlighter-rouge">ontology.PathType</code></a> is the type of <a href="uris.html">MMT URIs</a>.</li>
  <li><strong>Concepts</strong>, i.e., unary predicates on this type, are the subclasses of <a href="apidoc://info.kwarc.mmt.api.ontology.Unary"><code class="highlighter-rouge">ontology.Unary</code></a>.</li>
  <li><strong>Relations</strong>, i.e., binary relations between MMT URIs, are the subclasses of <a href="apidoc://info.kwarc.mmt.api.ontology.Binary"><code class="highlighter-rouge">ontology.Binary</code></a>.</li>
</ul>

<h3 id="maintenance-of-the-relational-knowledge-a-box">Maintenance of the Relational Knowledge (A-Box)</h3>

<p>On disk, the dimension <code class="highlighter-rouge">relational</code> of an <a href="../applications/archives.html">MMT archive</a> maintains the relational knowledge, i.e., the set of known URIs and the instances of the unary and binary predicates.
In memory, this is done by the class <a href="apidoc://info.kwarc.mmt.api.ontology.RelStore"><code class="highlighter-rouge">ontology.RelStore</code></a>. Refer to <a href="/uniformal.github.io/doc/api/query-examples.html">this list of query examples</a> for basic usage.</p>

<p>The relational dimension is written automatically when an import build target is used.
To load an archiveâ€™s relational knowledge into memory, the <a href="../applications/shell.html">shell</a> command <code class="highlighter-rouge">relational</code> can be used.</p>

<h3 id="evaluation">Evaluation</h3>

<p>The evaluation of queries is implemented in the <a href="apidoc://info.kwarc.mmt.api.ontology.Evaluator"><code class="highlighter-rouge">ontology.Evaluator</code></a>.
According to its type, every query evaluates to a tuple of base values or to a set of such tuples.
For each <a href="apidoc://info.kwarc.mmt.api.ontology.QueryType"><code class="highlighter-rouge">ontology.QueryType</code></a>, there is a corresponding subclass of <a href="apidoc://info.kwarc.mmt.api.ontology.BaseType"><code class="highlighter-rouge">ontology.BaseType</code></a>, from which the return type of evaluation is built.</p>

<p>Evaluation results can be used in the API or exported in ad-hoc XML syntax.</p>

<h3 id="extending-the-query-language">Extending the Query Language</h3>

<p>There is an <a href="extensions/">extension</a> for adding new atomic functions to the query language.
Several such functions expose basic algorithms (parsing, type checking, presentation, etc.) to the query language. See the documentation of <a href="apidoc://info.kwarc.mmt.api.ontology.QueryExtension"><code class="highlighter-rouge">ontology.QueryExtension</code></a>.</p>

<h3 id="querying-via-http">Querying via HTTP</h3>
<p>The MMT <a href="../applications/server.html">HTTP interface</a> opens a QMT query server that accepts a QMT query in XML encoding as the body of an HTTP POST request.
Some example queries are:</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;uris</span> <span class="na">concept=</span><span class="s">"C"</span><span class="nt">/&gt;</span>
</code></pre></div></div>

<p>retrieves all known MMT URIs of concept C.</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;related&gt;</span>
  <span class="nt">&lt;literal</span> <span class="na">uri=</span><span class="s">"T"</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;toobject</span> <span class="na">relation=</span><span class="s">"Declares"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/related&gt;</span>
</code></pre></div></div>

<p>retrieves all declarations of theory T.</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;related&gt;</span>
  <span class="nt">&lt;literal</span> <span class="na">uri=</span><span class="s">"T"</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;sequence&gt;</span>
    <span class="nt">&lt;transitive&gt;</span>
       <span class="nt">&lt;toobject</span> <span class="na">relation=</span><span class="s">"Includes"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/transitive&gt;</span>
    <span class="nt">&lt;toobject</span> <span class="na">relation=</span><span class="s">"Declares"</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;/sequence&gt;</span>
<span class="nt">&lt;/related&gt;</span>
</code></pre></div></div>

<p>retrieves all declarations of any theory included into theory T.</p>

<h3 id="querying-from-javascript">Querying from JavaScript</h3>
<p>The qmt object of the MMT JavaScript code provides bindings for building queries and an Ajax style interface for server side query evaluation.</p>

				</div>
			</div>
		</div>
	


	<div class="container">
		<footer class="container">

    <hr />
    <p>
        MMT is developed and maintained mostly by <a href="http://kwarc.info/frabe/" target="_blank">Florian Rabe</a>. <br />
        
        This page is hosted via github pages and can be edited <a href="https://github.com/UniFormal/uniformal.github.io/edit/master/doc/api/queries.md" target="_blank">directly in the browser</a>. <br/>
    </p>
</footer>
	</div>

    <script src="https://comfreek.github.io/uniformal.github.io/lib/js/jquery-3.3.1.min.js"></script>
    <script src="https://comfreek.github.io/uniformal.github.io/lib/js/bootstrap.min.js"></script>
		<script src="https://comfreek.github.io/uniformal.github.io/lib/js/doc.js"></script>
		<script src="https://comfreek.github.io/uniformal.github.io/lib/js/api.js"></script>
	
  </body>
</html>
